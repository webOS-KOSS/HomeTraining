"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = _default;

/* global Element */
function _default(set, remove) {
  var polyfilled = false;
  set(function () {
    if (!Element.prototype.closest) {
      // we're using detached nodes so we have to find the root node rather than the document
      var findRoot = function findRoot(n) {
        while (n && n.parentNode) {
          n = n.parentNode;
        }

        return n;
      };

      polyfilled = true;

      Element.prototype.closest = function (s) {
        var matches = findRoot(this).querySelectorAll(s),
            i,
            el = this;

        do {
          i = matches.length;

          while (--i >= 0 && matches.item(i) !== el) {// nothing
          }
        } while (i < 0 && (el = el.parentElement));

        return el;
      };
    }
  });
  remove(function () {
    if (polyfilled) {
      delete Element.prototype.closest;
    }
  });
}